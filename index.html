<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Territory Underwriter Finder</title>
    <style>
      :root {
        --brand: #0066cc;
        --brand-dark: #0057b7;
        --brand-light: #e6f2ff;
        --bg: #f4f7fc;
        --text: #333;
        --muted: #555;
        --chip-bg: #eaf3ff;
        --chip-text: #0b57d0;
        --mh-bg: #fff7e6;
        --mh-text: #8a5a00;
        --shadow: 0 2px 12px rgba(0, 102, 204, 0.08);
        --shadow-hover: 0 4px 20px rgba(0, 102, 204, 0.12);
      }

      * { box-sizing: border-box; }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #f4f7fc 0%, #e8f0fe 100%);
        margin: 0;
        padding: 0;
        color: var(--text);
        min-height: 100vh;
      }

      .Container { max-width: 1000px; margin: 0 auto; padding: 30px 20px; }

      header {
        background: linear-gradient(135deg, var(--brand) 0%, var(--brand-dark) 100%);
        color: white;
        padding: 32px 24px;
        text-align: center;
        border-radius: 16px 16px 0 0;
        box-shadow: var(--shadow);
      }

      h1 { margin: 0 0 8px 0; font-size: 32px; font-weight: 700; letter-spacing: -0.5px; }
      header p { margin: 0; opacity: 0.9; font-size: 14px; font-weight: 500; }

      .Section {
        background: white;
        padding: 32px;
        border-radius: 0 0 16px 16px;
        box-shadow: var(--shadow);
      }

      .Section>p { font-size: 15px; color: var(--muted); margin-bottom: 20px; line-height: 1.6; }

      .Section ul {
        list-style: none;
        padding: 0;
        margin-bottom: 28px;
        background: var(--brand-light);
        border-radius: 12px;
        padding: 20px 24px;
      }

      .Section li {
        margin-bottom: 10px;
        padding-left: 24px;
        position: relative;
        line-height: 1.6;
        font-size: 14px;
      }

      .Section li:before {
        content: "→";
        position: absolute;
        left: 0;
        color: var(--brand);
        font-weight: bold;
      }

      .Section li:last-child { margin-bottom: 0; }
      .Section li strong { color: var(--brand-dark); font-weight: 600; }

      .SearchRow {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 12px;
        align-items: center;
        margin-top: 12px;
      }

      .LabelRow {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
        margin-top: 12px;
      }

      .Chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        background: var(--chip-bg);
        color: var(--chip-text);
        transition: all 0.2s ease;
      }

      .Chip:hover { transform: translateY(-1px); box-shadow: 0 2px 8px rgba(11, 87, 208, 0.15); }

      .ChipMH { background: var(--mh-bg); color: var(--mh-text); }
      .ChipMH:hover { box-shadow: 0 2px 8px rgba(138, 90, 0, 0.15); }

      .FieldLabel { font-weight: 600; color: var(--text); font-size: 14px; }

      input[type="text"] {
        padding: 12px 16px;
        font-size: 15px;
        width: 100%;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        transition: all 0.3s ease;
        font-family: inherit;
      }

      input[type="text"]:focus {
        outline: none;
        border-color: var(--brand);
        box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
      }

      input[type="text"]::placeholder { color: #999; }

      button {
        padding: 12px 24px;
        font-size: 15px;
        font-weight: 600;
        background: linear-gradient(135deg, var(--brand) 0%, var(--brand-dark) 100%);
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        white-space: nowrap;
        box-shadow: 0 2px 8px rgba(0, 102, 204, 0.2);
      }

      button:hover { transform: translateY(-2px); box-shadow: var(--shadow-hover); }
      button:active { transform: translateY(0); }

      .Notice {
        font-size: 14px;
        color: var(--muted);
        margin-top: 24px;
        padding: 16px;
        background: var(--brand-light);
        border-radius: 10px;
        border-left: 4px solid var(--brand);
        line-height: 1.6;
      }

      .Results {
        margin-top: 16px;
        display: none;
        border: 2px solid var(--brand);
        border-radius: 12px;
        padding: 20px;
        background: var(--brand-light);
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from { opacity: 0; transform: translateY(-10px); }
        to   { opacity: 1; transform: translateY(0); }
      }

      .Results p { margin: 0; font-size: 16px; font-weight: 600; color: var(--brand-dark); }
      .Results span { color: var(--brand); font-weight: 700; }

      .Loading { display: none; text-align: center; margin-top: 16px; }
      .Spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid var(--brand);
        border-radius: 50%;
        width: 36px; height: 36px;
        animation: spin 0.8s linear infinite;
        margin: 0 auto;
      }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

      .TwoUp { display: grid; grid-template-columns: 1fr; gap: 24px; margin-top: 8px; }
      @media (min-width: 760px) { .TwoUp { grid-template-columns: 1fr 1fr; } }

      .Card {
        background: white;
        border: 2px solid #f0f0f0;
        border-radius: 16px;
        padding: 24px;
        transition: all 0.3s ease;
      }

      .Card:hover { border-color: var(--brand); box-shadow: var(--shadow-hover); transform: translateY(-2px); }

      .CardTitle { margin: 0 0 8px 0; font-size: 20px; font-weight: 700; color: var(--brand-dark); }

      footer {
        background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
        color: white;
        text-align: center;
        padding: 20px;
        margin-top: 30px;
        border-radius: 16px;
        box-shadow: var(--shadow);
      }

      footer p { margin: 0; font-size: 14px; opacity: 0.9; }
      @media (max-width: 759px) {
        h1 { font-size: 26px; }
        .Section { padding: 24px 20px; }
        .SearchRow { grid-template-columns: 1fr; }
        button { width: 100%; }
      }
    </style>
  </head>
  <body>
    <div class="Container">
      <header>
        <h1>Territory Underwriter Finder</h1>
        <p>Updated on 10/31/2025</p>
      </header>

      <div class="Section">
        <p>Please ensure that the new business policy is correctly classified as either Homeowners, Mobile Home, HO6, or Surplus. The appropriate person to handle each type of policy is as follows:</p>
        <ul>
          <li><strong>HO6:</strong> Jenny Y OOTO 10/31/25 = Barb.</li>
          <li><strong>Surplus (If It Is A Call Call Triage):</strong> BILLY @CC Pat R ; <strong> NJ:</strong> Pat O @CC Billy</li>
          <li><strong>MS &amp; AL:</strong> Trent P.</li>
          <li><strong>RI HO3:</strong> Wendi RI.</li>
          <li><strong>SC &amp; NC:</strong> Barbara P.</li>
          <li><strong>CA:</strong> Joe, Angie, Denise, Sara cc@ Pat R.</li>
        </ul>

        <div class="TwoUp">
          <div class="Card" aria-labelledby="GeneralSearchTitle">
            <h3 id="GeneralSearchTitle" class="CardTitle">General Search</h3>
            <div class="LabelRow">
              <span class="FieldLabel">Use this for:</span>
              <span class="Chip">Homeowners</span>
              <span class="Chip">HO6</span>
              <span class="Chip">Surplus</span>
            </div>
            <div class="SearchRow" style="margin-top:10px;">
              <input id="UserInputGeneral" type="text" placeholder="Enter Zip Code or County (e.g., 33411 or Palm Beach)" aria-label="General Search" />
              <button id="ButtonGeneral">Find Underwriter</button>
            </div>
            <div class="Loading" id="LoadingGeneral"><div class="Spinner"></div></div>
            <div class="Results" id="ResultsGeneral" aria-live="polite">
              <p>Underwriter Name: <span id="UnderwriterNameGeneral"></span></p>
            </div>
          </div>

          <div class="Card" aria-labelledby="MobileHomeSearchTitle">
            <h3 id="MobileHomeSearchTitle" class="CardTitle">Mobile Home Search</h3>
            <div class="LabelRow">
              <span class="FieldLabel">Use this for:</span>
              <span class="Chip ChipMH">Mobile Home</span>
            </div>
            <div class="SearchRow" style="margin-top:10px;">
              <input id="UserInputMobileHome" type="text" placeholder="Enter Zip Code or County (e.g., 32960 or Brevard)" aria-label="Mobile Home Search" />
              <button id="ButtonMobileHome">Find MH Underwriter</button>
            </div>
            <div class="Loading" id="LoadingMobileHome"><div class="Spinner"></div></div>
            <div class="Results" id="ResultsMobileHome" aria-live="polite">
              <p>Mobile Home UW: <span id="UnderwriterNameMobileHome"></span></p>
            </div>
          </div>
        </div>

        <p class="Notice">Kindly provide the agent's zip code, county, or state to assist in locating the appropriate territory underwriter.</p>
      </div>

      <footer>
        <p>&copy; 2025 Policy Services | All rights reserved.</p>
      </footer>
    </div>

    <!-- Load county → [zip,...] map (zip strings). Must define: window.ZipCodesData -->
    <script src="./ZIPCODE.js"></script>

    <script>
      // ===== Elements (PascalCase) =====
      const UserInputGeneral = document.getElementById('UserInputGeneral');
      const ButtonGeneral = document.getElementById('ButtonGeneral');
      const LoadingGeneral = document.getElementById('LoadingGeneral');
      const ResultsGeneral = document.getElementById('ResultsGeneral');
      const UnderwriterNameGeneral = document.getElementById('UnderwriterNameGeneral');

      const UserInputMobileHome = document.getElementById('UserInputMobileHome');
      const ButtonMobileHome = document.getElementById('ButtonMobileHome');
      const LoadingMobileHome = document.getElementById('LoadingMobileHome');
      const ResultsMobileHome = document.getElementById('ResultsMobileHome');
      const UnderwriterNameMobileHome = document.getElementById('UnderwriterNameMobileHome');

      // ===== Wire up click + Enter-to-search =====
      ButtonGeneral.addEventListener('click', FindUnderwriter);
      ButtonMobileHome.addEventListener('click', FindMobileHomeUnderwriter);

      UserInputGeneral.addEventListener('keypress', (Evt) => {
        if (Evt.key === 'Enter') { Evt.preventDefault(); ButtonGeneral.click(); }
      });

      UserInputMobileHome.addEventListener('keypress', (Evt) => {
        if (Evt.key === 'Enter') { Evt.preventDefault(); ButtonMobileHome.click(); }
      });

      // ===== Underwriters (counties only) =====
      const Underwriters = {
        "CHAD NB AND CLAIMS": {
          "counties": ["GLADES", "PALM BEACH", "HENDRY", "LEE", "COLLIER", "BROWARD", "MIAMI-DADE", "MONROE", "MARTIN"]
        },
        "TRENT PHILLIPS = NB & CLAIMS": {
          "counties": ["ESCAMBIA", "PUTNAM", "CLAY", "SANTA ROSA", "OKALOOSA", "WALTON", " HOLMES", "WASHINGTON", "BAY", "JACKSON", "CALHOUN", "GULF", "LIBERTY", "GADSDEN", "FRANKLIN", "LEON", "WAKULLA", "JEFFERSON", "MADISON", "TAYLOR", "DIXIE", "LAFAYETTE", "SUWANNEE", "HAMILTON", "COLUMBIA", "GILCHRIST", "LEVY", "ALACHUA", "UNION", "BAKER", "BRADFORD"]
        },
        "BRYAN HASSELL": {
          "counties": ["CITRUS", "HERNANDO", "PASCO", "HILLSBOROUGH", "PINELLAS", "MANATEE", "SARASOTA", "CHARLOTTE"]
        },
        "TRENT PHILLIPS": {
          "counties": ["SEMINOLE", "ORANGE"]
        },
        "TRENT PHILLIPS Claims, DWAYANE": {
          "counties": ["MARION", "FLAGLER", "VOLUSIA", "DUVAL", "ST JOHNS"]
        },
        "ANGIE ESTRADA, JOE, DENISE, SARA THOMAS @cc PATRICK RENNIE": {
          "counties": ["CALIFORNIA", "CA"]
        },
        "Patrick O'Neill @cc Billy": {
          "counties": ["NEW JERSEY", "NJ"]
        },
        "PAT MALONE @cc AMANDA WHITTLE (SUFFOLK COUNTY = SCOTT @cc AMANDA WHITTLE)": {
          "counties": ["NEW YORK", "NY"]
        },
        "SCOTT SULLIVAN OOTO UP TO 11/03 @cc AMANDA WHITTLE": {
          "counties": ["SUFFOLK"]
        },
        "RICH EDWARDS": {
          "counties": ["LAKE", "SUMTER", "POLK", "OSCEOLA", "HARDEE", "HIGHLANDS", "OKEECHOBEE", "DESOTO", "BREVARD", "INDIAN RIVER", "SAINT LUCIE"]
        },
        "BARBARA PHELPS": {
          "counties": ["SOUTH CAROLINA", "SC", "NC", "NORTH CAROLINA"]
        }
      };

      // ===== Mobile Home Underwriters (counties only) =====
      const MobileHomeUnderwriters = {
        "Laurie": {
          "counties": ["ESCAMBIA", "SANTA ROSA", "OKALOOSA", "WALTON", "HOLMES", "WASHINGTON", "JACKSON", "CALHOUN", "BAY", "GULF", "FRANKLIN", "LIBERTY", "GADSDEN", "LEON", "WAKULLA", "JEFFERSON", "MADISON", "TAYLOR", "LAFAYETTE", "SUWANNEE", "HAMILTON", "COLUMBIA", "GILCHRIST", "DIXIE", "LEVY", "ALACHUA", "BAKER", "UNION", "BRADFORD", "SUMTER", "CITRUS", "HERNANDO", "PASCO", "HILLSBOROUGH"]
        },
        "Wanda": {
          "counties": ["NASSAU", "DUVAL", "CLAY", "ST JOHNS", "PUTNAM", "FLAGLER", "MARION", "LAKE", "SEMINOLE", "ORANGE", "VOLUSIA", "BREVARD", "POLK", "OSCEOLA", "INDIAN RIVER", "SAINT LUCIE", "MARTIN", "PALM BEACH", "BROWARD", "MIAMI-DADE", "MONROE", "MANATEE", "SARASOTA", "DESOTO", "CHARLOTTE", "GLADES", "HARDEE", "HIGHLANDS", "LEE", "HENDRY", "COLLIER", "OKEECHOBEE"]
        }
      };

      // ===== Helpers =====
      function NormalizeCountyName(Name) {
        return (Name || '')
          .trim()
          .toUpperCase()
          .replace(/\s+/g, ' '); // collapse spaces, keep hyphens as-is
      }

      function ParseZipOrCounty(InputValue) {
        const Raw = (InputValue || '').trim();
        if (!Raw) return { kind: 'empty' };
        const ZipMatch = Raw.match(/^\s*(\d{5})/); // first 5 digits even if ZIP+4
        if (ZipMatch) return { kind: 'zip', value: ZipMatch[1].padStart(5, '0') }; // keep as string
        return { kind: 'county', value: NormalizeCountyName(Raw) };
      }

      // Core lookup using assigned counties first, then ZIP->county via ZipCodesData
      function LookupUnderwriterByTerritories(TerritoriesMap, InputValue) {
        const Parsed = ParseZipOrCounty(InputValue);

        if (Parsed.kind === 'empty') return null;

        // 1) County-first
        if (Parsed.kind === 'county') {
          const CountyName = NormalizeCountyName(Parsed.value);
          for (const UwName in TerritoriesMap) {
            const UwCounties = (TerritoriesMap[UwName].counties || []).map(NormalizeCountyName);
            if (UwCounties.includes(CountyName)) return UwName;
          }
          return null;
        }

        // 2) ZIP -> county -> underwriter
        if (Parsed.kind === 'zip') {
          const ZipString = String(Parsed.value).slice(0, 5).padStart(5, '0');

          const ZipData = (window.ZipCodesData || {});

          for (const [County, Zips] of Object.entries(ZipData)) {
            // Zip lists are strings in ZipCodesData
            if ((Zips || []).includes(ZipString)) {
              const NormalCounty = NormalizeCountyName(County);
              for (const UwName in TerritoriesMap) {
                const UwCounties = (TerritoriesMap[UwName].counties || []).map(NormalizeCountyName);
                if (UwCounties.includes(NormalCounty)) return UwName;
              }
            }
          }
          return null;
        }

        return null;
      }

      function ShowResult(BlockEls, UwName) {
        const { loadingEl, resultsEl, nameEl } = BlockEls;
        loadingEl.style.display = 'none';
        nameEl.textContent = UwName || 'No underwriter found for this input.';
        resultsEl.style.display = 'block';
      }

      function ResetResults(BlockEls) {
        const { loadingEl, resultsEl, nameEl } = BlockEls;
        loadingEl.style.display = 'none';
        resultsEl.style.display = 'none';
        nameEl.textContent = '';
      }

      // Reset stale results while typing
      [UserInputGeneral, UserInputMobileHome].forEach((Input) => {
        Input.addEventListener('input', () => {
          ResetResults({ loadingEl: LoadingGeneral, resultsEl: ResultsGeneral, nameEl: UnderwriterNameGeneral });
          ResetResults({ loadingEl: LoadingMobileHome, resultsEl: ResultsMobileHome, nameEl: UnderwriterNameMobileHome });
        });
      });

      // ===== Actions =====
      function FindUnderwriter() {
        const UserInput = UserInputGeneral.value.trim();
        if (!UserInput) { alert('Please enter a zip code or county.'); return; }
        LoadingGeneral.style.display = 'block';
        ResultsGeneral.style.display = 'none';
        setTimeout(() => {
          const Uw = LookupUnderwriterByTerritories(Underwriters, UserInput);
          ShowResult({ loadingEl: LoadingGeneral, resultsEl: ResultsGeneral, nameEl: UnderwriterNameGeneral }, Uw);
        }, 200);
      }

      function FindMobileHomeUnderwriter() {
        const UserInput = UserInputMobileHome.value.trim();
        if (!UserInput) { alert('Please enter a zip code or county.'); return; }
        LoadingMobileHome.style.display = 'block';
        ResultsMobileHome.style.display = 'none';
        setTimeout(() => {
          const Uw = LookupUnderwriterByTerritories(MobileHomeUnderwriters, UserInput);
          ShowResult({ loadingEl: LoadingMobileHome, resultsEl: ResultsMobileHome, nameEl: UnderwriterNameMobileHome }, Uw);
        }, 200);
      }
    </script>
  </body>
</html>
